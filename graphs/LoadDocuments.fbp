# This graph loads a list of documents from a directory and sends it out for processing
Directory(Split) OUT -> SOURCE Dir(ReadDir)
Directory() OUT -> IN Display(Output)
Dir() OUT -> IN Stat(Stat)

# Routing rules
'isDirectory' -> ROUTES FileRouter(GroupRouter)
'isDirectory' -> KEY Group(GroupByObjectKey)
Stat() OUT -> IN Group() OUT -> IN FileRouter()

# First route: subfolder
'path=^(?:(?!\.git).)*$' -> REGEXP FilterDirs(FilterPropertyValue)
'path' -> KEY SubDirectory(GetObjectKey)
FileRouter() OUT -> IN FilterDirs() OUT -> IN SubDirectory()

# Fallback route: regular file
FileRouter() MISSED -> IN Drop(Drop)

# Error handling
Dir() ERROR -> IN Display(Output)
Stat() ERROR -> IN Display(Output)
